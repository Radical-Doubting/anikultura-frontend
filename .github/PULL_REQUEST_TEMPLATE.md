<!--
Please don't open huge pull requests and keep one pull request solving one problem.
-->

### Proposed changes

- See commits.
